#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Aè‚¡æ™ºèƒ½åˆ†æç³»ç»Ÿ - GUIç‰ˆæœ¬ (ç®€åŒ–ç‰ˆ)
å…¼å®¹Python 3.7+ï¼Œä½¿ç”¨åŸºç¡€åº“å®ç°
"""

import tkinter as tk
from tkinter import ttk, scrolledtext, messagebox
import json
import urllib.request
import urllib.parse
import threading
import random
from datetime import datetime, timedelta
import warnings
warnings.filterwarnings('ignore')

class AShareAnalyzerGUI:
    """Aè‚¡åˆ†æç³»ç»ŸGUIç•Œé¢"""
    
    def __init__(self, root):
        self.root = root
        self.setup_ui()
        self.stock_info = {
            "688981": {"name": "ä¸­èŠ¯å›½é™…", "industry": "åŠå¯¼ä½“åˆ¶é€ ", "concept": "èŠ¯ç‰‡æ¦‚å¿µ,ç§‘åˆ›æ¿", "price": 128.55},
            "600036": {"name": "æ‹›å•†é“¶è¡Œ", "industry": "é“¶è¡Œ", "concept": "é‡‘èè‚¡,è“ç­¹è‚¡", "price": 35.88},
            "000002": {"name": "ä¸‡ç§‘A", "industry": "æˆ¿åœ°äº§", "concept": "åœ°äº§è‚¡,ç™½é©¬è‚¡", "price": 8.95},
            "300750": {"name": "å®å¾·æ—¶ä»£", "industry": "æ–°èƒ½æºç”µæ± ", "concept": "æ–°èƒ½æº,é”‚ç”µæ± ", "price": 195.50},
            "600519": {"name": "è´µå·èŒ…å°", "industry": "ç™½é…’", "concept": "æ¶ˆè´¹è‚¡,æ ¸å¿ƒèµ„äº§", "price": 1688.00},
            "000858": {"name": "äº”ç²®æ¶²", "industry": "ç™½é…’", "concept": "æ¶ˆè´¹è‚¡,ç™½é…’", "price": 138.88},
            "002415": {"name": "æµ·åº·å¨è§†", "industry": "å®‰é˜²è®¾å¤‡", "concept": "ç§‘æŠ€è‚¡,ç›‘æ§", "price": 30.45},
            "300059": {"name": "ä¸œæ–¹è´¢å¯Œ", "industry": "é‡‘èæœåŠ¡", "concept": "äº’è”ç½‘é‡‘è", "price": 12.88},
            "600036": {"name": "æ‹›å•†é“¶è¡Œ", "industry": "é“¶è¡Œ", "concept": "é“¶è¡Œè‚¡,æ ¸å¿ƒèµ„äº§", "price": 35.88},
            "000001": {"name": "å¹³å®‰é“¶è¡Œ", "industry": "é“¶è¡Œ", "concept": "é“¶è¡Œè‚¡,é›¶å”®é“¶è¡Œ", "price": 10.55},
            "002594": {"name": "æ¯”äºšè¿ª", "industry": "æ–°èƒ½æºæ±½è½¦", "concept": "æ–°èƒ½æº,æ±½è½¦", "price": 280.00},
        }
    
    def setup_ui(self):
        """è®¾ç½®ç”¨æˆ·ç•Œé¢"""
        self.root.title("ğŸ‡¨ğŸ‡³ Aè‚¡æ™ºèƒ½åˆ†æç³»ç»Ÿ v2.0")
        self.root.geometry("1200x800")
        self.root.configure(bg="#f0f0f0")
        
        # è®¾ç½®æ ·å¼
        style = ttk.Style()
        style.theme_use('clam')
        
        # ä¸»æ ‡é¢˜
        title_frame = tk.Frame(self.root, bg="#2c3e50", height=60)
        title_frame.pack(fill="x", pady=(0, 10))
        title_frame.pack_propagate(False)
        
        title_label = tk.Label(title_frame, 
                              text="ğŸ‡¨ğŸ‡³ Aè‚¡æ™ºèƒ½åˆ†æç³»ç»Ÿ", 
                              font=("å¾®è½¯é›…é»‘", 18, "bold"), 
                              fg="white", 
                              bg="#2c3e50")
        title_label.pack(expand=True)
        
        # è¾“å…¥åŒºåŸŸ
        input_frame = tk.Frame(self.root, bg="#f0f0f0")
        input_frame.pack(fill="x", padx=20, pady=10)
        
        # è‚¡ç¥¨ä»£ç è¾“å…¥
        tk.Label(input_frame, text="è‚¡ç¥¨ä»£ç :", font=("å¾®è½¯é›…é»‘", 12), bg="#f0f0f0").pack(side="left")
        
        self.ticker_var = tk.StringVar()
        self.ticker_entry = tk.Entry(input_frame, 
                                   textvariable=self.ticker_var, 
                                   font=("å¾®è½¯é›…é»‘", 12), 
                                   width=10)
        self.ticker_entry.pack(side="left", padx=(10, 20))
        
        # åˆ†ææŒ‰é’®
        self.analyze_btn = tk.Button(input_frame, 
                                   text="ğŸ” å¼€å§‹åˆ†æ", 
                                   font=("å¾®è½¯é›…é»‘", 12, "bold"),
                                   bg="#3498db", 
                                   fg="white",
                                   activebackground="#2980b9",
                                   command=self.start_analysis,
                                   cursor="hand2")
        self.analyze_btn.pack(side="left", padx=10)
        
        # æ¸…ç©ºæŒ‰é’®
        clear_btn = tk.Button(input_frame, 
                            text="ğŸ—‘ï¸ æ¸…ç©º", 
                            font=("å¾®è½¯é›…é»‘", 12),
                            bg="#95a5a6", 
                            fg="white",
                            activebackground="#7f8c8d",
                            command=self.clear_results,
                            cursor="hand2")
        clear_btn.pack(side="left", padx=10)
        
        # ç¤ºä¾‹ä»£ç æŒ‰é’®
        example_btn = tk.Button(input_frame, 
                              text="ğŸ“‹ ç¤ºä¾‹", 
                              font=("å¾®è½¯é›…é»‘", 12),
                              bg="#9b59b6", 
                              fg="white",
                              activebackground="#8e44ad",
                              command=self.show_examples,
                              cursor="hand2")
        example_btn.pack(side="left", padx=10)
        
        # ç¤ºä¾‹ä»£ç 
        example_frame = tk.Frame(self.root, bg="#f0f0f0")
        example_frame.pack(fill="x", padx=20)
        
        tk.Label(example_frame, 
                text="ğŸ’¡ æ”¯æŒä»£ç : 688981(ä¸­èŠ¯å›½é™…) | 600036(æ‹›å•†é“¶è¡Œ) | 000002(ä¸‡ç§‘A) | 300750(å®å¾·æ—¶ä»£) | 600519(è´µå·èŒ…å°)", 
                font=("å¾®è½¯é›…é»‘", 10), 
                fg="#7f8c8d", 
                bg="#f0f0f0").pack()
        
        # è¿›åº¦æ¡
        self.progress_frame = tk.Frame(self.root, bg="#f0f0f0")
        self.progress_frame.pack(fill="x", padx=20, pady=10)
        
        self.progress_var = tk.StringVar()
        self.progress_label = tk.Label(self.progress_frame, 
                                     textvariable=self.progress_var, 
                                     font=("å¾®è½¯é›…é»‘", 10), 
                                     bg="#f0f0f0")
        self.progress_label.pack()
        
        self.progress_bar = ttk.Progressbar(self.progress_frame, 
                                          mode='indeterminate')
        
        # ç»“æœæ˜¾ç¤ºåŒºåŸŸ
        result_frame = tk.Frame(self.root, bg="#f0f0f0")
        result_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        # åˆ›å»ºNotebookç”¨äºåˆ†é¡µæ˜¾ç¤º
        self.notebook = ttk.Notebook(result_frame)
        self.notebook.pack(fill="both", expand=True)
        
        # æ¦‚è§ˆé¡µé¢
        self.overview_frame = tk.Frame(self.notebook, bg="white")
        self.notebook.add(self.overview_frame, text="ğŸ“Š æ¦‚è§ˆ")
        
        self.overview_text = scrolledtext.ScrolledText(self.overview_frame, 
                                                     font=("Consolas", 10),
                                                     wrap=tk.WORD,
                                                     bg="white")
        self.overview_text.pack(fill="both", expand=True, padx=10, pady=10)
        
        # æŠ€æœ¯åˆ†æé¡µé¢
        self.technical_frame = tk.Frame(self.notebook, bg="white")
        self.notebook.add(self.technical_frame, text="ğŸ“ˆ æŠ€æœ¯é¢")
        
        self.technical_text = scrolledtext.ScrolledText(self.technical_frame, 
                                                      font=("Consolas", 10),
                                                      wrap=tk.WORD,
                                                      bg="white")
        self.technical_text.pack(fill="both", expand=True, padx=10, pady=10)
        
        # åŸºæœ¬é¢åˆ†æé¡µé¢
        self.fundamental_frame = tk.Frame(self.notebook, bg="white")
        self.notebook.add(self.fundamental_frame, text="ğŸ’¼ åŸºæœ¬é¢")
        
        self.fundamental_text = scrolledtext.ScrolledText(self.fundamental_frame, 
                                                        font=("Consolas", 10),
                                                        wrap=tk.WORD,
                                                        bg="white")
        self.fundamental_text.pack(fill="both", expand=True, padx=10, pady=10)
        
        # æŠ•èµ„å»ºè®®é¡µé¢
        self.recommendation_frame = tk.Frame(self.notebook, bg="white")
        self.notebook.add(self.recommendation_frame, text="ğŸ¯ æŠ•èµ„å»ºè®®")
        
        self.recommendation_text = scrolledtext.ScrolledText(self.recommendation_frame, 
                                                           font=("Consolas", 10),
                                                           wrap=tk.WORD,
                                                           bg="white")
        self.recommendation_text.pack(fill="both", expand=True, padx=10, pady=10)
        
        # çŠ¶æ€æ 
        status_frame = tk.Frame(self.root, bg="#ecf0f1", height=30)
        status_frame.pack(fill="x")
        status_frame.pack_propagate(False)
        
        self.status_var = tk.StringVar()
        self.status_var.set("ğŸŸ¢ å°±ç»ª - è¯·è¾“å…¥è‚¡ç¥¨ä»£ç å¼€å§‹åˆ†æ")
        status_label = tk.Label(status_frame, 
                              textvariable=self.status_var, 
                              font=("å¾®è½¯é›…é»‘", 10), 
                              bg="#ecf0f1",
                              anchor="w")
        status_label.pack(fill="x", padx=10, pady=5)
        
        # ç»‘å®šå›è½¦é”®
        self.ticker_entry.bind('<Return>', lambda event: self.start_analysis())
        
        # æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        self.show_welcome_message()
    
    def show_examples(self):
        """æ˜¾ç¤ºç¤ºä¾‹è‚¡ç¥¨ä»£ç """
        examples = ["688981", "600036", "000002", "300750", "600519", "000858", "002415", "300059"]
        example = random.choice(examples)
        self.ticker_var.set(example)
        messagebox.showinfo("ç¤ºä¾‹ä»£ç ", f"å·²å¡«å…¥ç¤ºä¾‹è‚¡ç¥¨ä»£ç : {example}\nç‚¹å‡»'å¼€å§‹åˆ†æ'æŒ‰é’®è¿›è¡Œåˆ†æ")
    
    def show_welcome_message(self):
        """æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯"""
        welcome_msg = """
ğŸ‰ æ¬¢è¿ä½¿ç”¨Aè‚¡æ™ºèƒ½åˆ†æç³»ç»Ÿï¼

ğŸ“‹ ä½¿ç”¨è¯´æ˜:
1. åœ¨ä¸Šæ–¹è¾“å…¥æ¡†è¾“å…¥6ä½è‚¡ç¥¨ä»£ç ï¼ˆå¦‚ï¼š688981ï¼‰
2. ç‚¹å‡»"å¼€å§‹åˆ†æ"æŒ‰é’®æˆ–æŒ‰å›è½¦é”®
3. ç­‰å¾…åˆ†æå®Œæˆï¼ŒæŸ¥çœ‹å„ä¸ªé¡µé¢çš„åˆ†æç»“æœ

ğŸ” æ”¯æŒçš„è‚¡ç¥¨æ ¼å¼:
â€¢ ä¸Šæµ·ä¸»æ¿: 60XXXX (å¦‚ï¼š600036-æ‹›å•†é“¶è¡Œ)
â€¢ ç§‘åˆ›æ¿: 688XXX (å¦‚ï¼š688981-ä¸­èŠ¯å›½é™…) 
â€¢ æ·±åœ³ä¸»æ¿: 000XXX (å¦‚ï¼š000002-ä¸‡ç§‘A)
â€¢ åˆ›ä¸šæ¿: 300XXX (å¦‚ï¼š300750-å®å¾·æ—¶ä»£)

ğŸ’¡ åˆ†æå†…å®¹åŒ…æ‹¬:
â€¢ ğŸ“Š è‚¡ç¥¨æ¦‚è§ˆ - åŸºæœ¬ä¿¡æ¯å’Œå¸‚åœºç¯å¢ƒ
â€¢ ğŸ“ˆ æŠ€æœ¯é¢åˆ†æ - æŠ€æœ¯æŒ‡æ ‡å’Œè¶‹åŠ¿åˆ¤æ–­
â€¢ ğŸ’¼ åŸºæœ¬é¢åˆ†æ - è´¢åŠ¡æ•°æ®å’Œä¼°å€¼åˆ†æ
â€¢ ğŸ¯ æŠ•èµ„å»ºè®® - ç»¼åˆè¯„çº§å’Œæ“ä½œç­–ç•¥

âš ï¸ é£é™©æç¤º:
è‚¡å¸‚æœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ï¼
æœ¬ç³»ç»Ÿä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚

ğŸš€ ç°åœ¨å°±å¼€å§‹æ‚¨çš„Aè‚¡æŠ•èµ„åˆ†æä¹‹æ—…å§ï¼

ğŸ’ ç‰¹è‰²åŠŸèƒ½:
â€¢ æ”¯æŒAè‚¡ç‰¹è‰²æ¿å—åˆ†æ
â€¢ æ™ºèƒ½æŠ•èµ„ç­–ç•¥å»ºè®®
â€¢ é£é™©è¯„ä¼°å’Œä»“ä½å»ºè®®
â€¢ å®æ—¶å¸‚åœºç¯å¢ƒåˆ†æ

ğŸ†• ç‰ˆæœ¬æ›´æ–° (v2.0):
â€¢ å…¨æ–°å›¾å½¢ç•Œé¢è®¾è®¡
â€¢ å¤šé¡µé¢åˆ†ç±»å±•ç¤ºåˆ†æç»“æœ
â€¢ æ™ºèƒ½è‚¡ç¥¨ä»£ç è¯†åˆ«
â€¢ å¢å¼ºçš„Aè‚¡å¸‚åœºç‰¹è‰²åˆ†æ
        """
        
        self.overview_text.delete('1.0', tk.END)
        self.overview_text.insert('1.0', welcome_msg)
    
    def start_analysis(self):
        """å¼€å§‹åˆ†æ"""
        ticker = self.ticker_var.get().strip()
        if not ticker:
            messagebox.showwarning("è­¦å‘Š", "è¯·è¾“å…¥è‚¡ç¥¨ä»£ç ï¼")
            return
        
        if not (ticker.isdigit() and len(ticker) == 6):
            messagebox.showwarning("è­¦å‘Š", "è¯·è¾“å…¥æ­£ç¡®çš„6ä½è‚¡ç¥¨ä»£ç ï¼")
            return
        
        if ticker not in self.stock_info:
            messagebox.showwarning("æç¤º", f"æš‚ä¸æ”¯æŒè‚¡ç¥¨ä»£ç  {ticker}ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ç¤ºä¾‹ä»£ç ä¹‹ä¸€ï¼š\n\nâ€¢ 688981 (ä¸­èŠ¯å›½é™…)\nâ€¢ 600036 (æ‹›å•†é“¶è¡Œ)\nâ€¢ 000002 (ä¸‡ç§‘A)\nâ€¢ 300750 (å®å¾·æ—¶ä»£)\nâ€¢ 600519 (è´µå·èŒ…å°)\nâ€¢ 000858 (äº”ç²®æ¶²)\nâ€¢ 002415 (æµ·åº·å¨è§†)\nâ€¢ 300059 (ä¸œæ–¹è´¢å¯Œ)")
            return
        
        # ç¦ç”¨åˆ†ææŒ‰é’®
        self.analyze_btn.config(state="disabled")
        
        # æ˜¾ç¤ºè¿›åº¦æ¡
        self.progress_bar.pack(fill="x", pady=5)
        self.progress_bar.start()
        self.progress_var.set("ğŸ”„ æ­£åœ¨åˆ†æä¸­ï¼Œè¯·ç¨å€™...")
        
        # æ›´æ–°çŠ¶æ€
        self.status_var.set(f"ğŸŸ¡ æ­£åœ¨åˆ†æ {ticker}...")
        
        # åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œåˆ†æ
        analysis_thread = threading.Thread(target=self.perform_analysis, args=(ticker,))
        analysis_thread.daemon = True
        analysis_thread.start()
    
    def perform_analysis(self, ticker):
        """æ‰§è¡Œåˆ†æï¼ˆåœ¨åå°çº¿ç¨‹ä¸­ï¼‰"""
        try:
            # æ¨¡æ‹Ÿåˆ†æè¿‡ç¨‹
            import time
            
            self.update_progress("ğŸ“¡ æ­£åœ¨è·å–è‚¡ç¥¨æ•°æ®...")
            time.sleep(1)
            
            self.update_progress("ğŸ“Š æ­£åœ¨è¿›è¡ŒæŠ€æœ¯é¢åˆ†æ...")
            time.sleep(1)
            technical_analysis = self.technical_analysis(ticker)
            
            self.update_progress("ğŸ’¼ æ­£åœ¨è¿›è¡ŒåŸºæœ¬é¢åˆ†æ...")
            time.sleep(1)
            fundamental_analysis = self.fundamental_analysis(ticker)
            
            self.update_progress("ğŸ¯ æ­£åœ¨ç”ŸæˆæŠ•èµ„å»ºè®®...")
            time.sleep(1)
            overview = self.generate_overview(ticker)
            
            # ç”ŸæˆæŠ•èµ„å»ºè®®
            technical_score = random.uniform(6, 8)
            fundamental_score = random.uniform(5, 7)
            recommendation = self.generate_investment_recommendation(ticker, technical_score, fundamental_score)
            
            # åœ¨ä¸»çº¿ç¨‹ä¸­æ›´æ–°UI
            self.root.after(0, self.update_results, overview, technical_analysis, fundamental_analysis, recommendation, ticker)
            
        except Exception as e:
            self.root.after(0, self.show_error, str(e))
    
    def update_progress(self, message):
        """æ›´æ–°è¿›åº¦ä¿¡æ¯"""
        self.root.after(0, lambda: self.progress_var.set(message))
    
    def update_results(self, overview, technical, fundamental, recommendation, ticker):
        """æ›´æ–°åˆ†æç»“æœ"""
        # æ¸…ç©ºæ‰€æœ‰æ–‡æœ¬æ¡†
        self.overview_text.delete('1.0', tk.END)
        self.technical_text.delete('1.0', tk.END)
        self.fundamental_text.delete('1.0', tk.END)
        self.recommendation_text.delete('1.0', tk.END)
        
        # æ’å…¥åˆ†æç»“æœ
        self.overview_text.insert('1.0', overview)
        self.technical_text.insert('1.0', technical)
        self.fundamental_text.insert('1.0', fundamental)
        self.recommendation_text.insert('1.0', recommendation)
        
        # éšè—è¿›åº¦æ¡
        self.progress_bar.stop()
        self.progress_bar.pack_forget()
        self.progress_var.set("")
        
        # å¯ç”¨åˆ†ææŒ‰é’®
        self.analyze_btn.config(state="normal")
        
        # æ›´æ–°çŠ¶æ€
        self.status_var.set(f"âœ… {ticker} åˆ†æå®Œæˆ")
        
        # åˆ‡æ¢åˆ°æ¦‚è§ˆé¡µé¢
        self.notebook.select(0)
    
    def show_error(self, error_msg):
        """æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯"""
        self.progress_bar.stop()
        self.progress_bar.pack_forget()
        self.progress_var.set("")
        self.analyze_btn.config(state="normal")
        
        self.status_var.set("âŒ åˆ†æå¤±è´¥")
        messagebox.showerror("é”™è¯¯", f"åˆ†æå¤±è´¥ï¼š{error_msg}")
    
    def clear_results(self):
        """æ¸…ç©ºç»“æœ"""
        self.overview_text.delete('1.0', tk.END)
        self.technical_text.delete('1.0', tk.END)
        self.fundamental_text.delete('1.0', tk.END)
        self.recommendation_text.delete('1.0', tk.END)
        
        self.ticker_var.set("")
        self.status_var.set("ğŸŸ¢ å°±ç»ª - è¯·è¾“å…¥è‚¡ç¥¨ä»£ç å¼€å§‹åˆ†æ")
        
        # æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        self.show_welcome_message()
    
    def generate_overview(self, ticker):
        """ç”Ÿæˆæ¦‚è§ˆä¿¡æ¯"""
        stock_info = self.stock_info.get(ticker, {})
        current_price = stock_info.get("price", 0)
        
        # ç”Ÿæˆéšæœºçš„å¸‚åœºæ•°æ®ç”¨äºæ¼”ç¤º
        price_change = random.uniform(-2.5, 2.5)
        price_change_pct = (price_change / current_price) * 100
        
        overview = f"""
ğŸ‡¨ğŸ‡³ Aè‚¡æ™ºèƒ½åˆ†æç³»ç»Ÿ - è‚¡ç¥¨æ¦‚è§ˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š åŸºæœ¬ä¿¡æ¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è‚¡ç¥¨ä»£ç : {ticker}
å…¬å¸åç§°: {stock_info.get('name', 'æœªçŸ¥')}
æ‰€å±è¡Œä¸š: {stock_info.get('industry', 'æœªçŸ¥')}
æŠ•èµ„æ¦‚å¿µ: {stock_info.get('concept', 'æœªçŸ¥')}
å½“å‰ä»·æ ¼: Â¥{current_price:.2f}
ä»·æ ¼å˜åŠ¨: Â¥{price_change:+.2f} ({price_change_pct:+.2f}%)
åˆ†ææ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}

ğŸ›ï¸ æ¿å—ç‰¹å¾
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
        
        if ticker.startswith('688'):
            overview += """
ğŸ”¬ ç§‘åˆ›æ¿è‚¡ç¥¨
â€¢ ç§‘æŠ€åˆ›æ–°ä¼ä¸šï¼Œæˆé•¿æ€§è¾ƒé«˜
â€¢ æŠ•èµ„é—¨æ§›50ä¸‡ï¼Œæœºæ„æŠ•èµ„è€…è¾ƒå¤š
â€¢ ä¼°å€¼æº¢ä»·æ˜æ˜¾ï¼Œæ³¢åŠ¨æ€§å¤§
â€¢ æ³¨å†Œåˆ¶ä¸Šå¸‚ï¼Œå¸‚åœºåŒ–ç¨‹åº¦é«˜
â€¢ é€‚åˆç§‘æŠ€æŠ•èµ„å’Œæˆé•¿æŠ•èµ„
"""
        elif ticker.startswith('300'):
            overview += """
ğŸš€ åˆ›ä¸šæ¿è‚¡ç¥¨
â€¢ ä¸­å°æˆé•¿ä¼ä¸šä¸ºä¸»
â€¢ å¸‚åœºæ´»è·ƒåº¦é«˜ï¼ŒæŠ•æœºæ€§è¾ƒå¼º
â€¢ æ³¨å†Œåˆ¶æ”¹é©ï¼Œä¼˜èƒœåŠ£æ±°
â€¢ é€‚åˆé£é™©åå¥½é«˜çš„æŠ•èµ„è€…
â€¢ å…³æ³¨ä¸šç»©å¢é•¿å¯æŒç»­æ€§
"""
        elif ticker.startswith('60'):
            overview += """
ğŸ¢ æ²ªå¸‚ä¸»æ¿
â€¢ å¤§å‹æˆç†Ÿä¼ä¸šä¸ºä¸»
â€¢ è“ç­¹è‚¡é›†ä¸­åœ°ï¼Œåˆ†çº¢ç¨³å®š
â€¢ ç›¸å¯¹ç¨³å®šï¼Œæ³¢åŠ¨æ€§è¾ƒå°
â€¢ é€‚åˆç¨³å¥å‹æŠ•èµ„è€…
â€¢ ä»·å€¼æŠ•èµ„ä¼˜é€‰æ¿å—
"""
        elif ticker.startswith('00'):
            overview += """
ğŸ­ æ·±å¸‚ä¸»æ¿
â€¢ åˆ¶é€ ä¸šä¼ä¸šè¾ƒå¤š
â€¢ æ°‘è¥ä¼ä¸šå æ¯”é«˜
â€¢ ç»è¥çµæ´»æ€§å¼º
â€¢ å…³æ³¨è¡Œä¸šå‘¨æœŸå½±å“
â€¢ æˆé•¿ä¸ä»·å€¼å…¼å…·
"""
        
        overview += f"""
ğŸŒ å¸‚åœºç¯å¢ƒåˆ†æ (2025å¹´10æœˆ)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“ˆ Aè‚¡æ•´ä½“æ€åŠ¿:
â€¢ æ”¿ç­–ç¯å¢ƒ: ç¨³å¢é•¿æ”¿ç­–æŒç»­å‘åŠ›ï¼Œæ”¯æŒå®ä½“ç»æµå‘å±•
â€¢ æµåŠ¨æ€§çŠ¶å†µ: å¤®è¡Œç»´æŒç¨³å¥è´§å¸æ”¿ç­–ï¼Œå¸‚åœºæµåŠ¨æ€§åˆç†å……è£•  
â€¢ ä¼°å€¼æ°´å¹³: æ•´ä½“ä¼°å€¼å¤„äºå†å²ä¸­ä½æ•°ï¼Œç»“æ„æ€§æœºä¼šæ˜¾è‘—
â€¢ å›½é™…èµ„é‡‘: å¤–èµ„å¯¹ä¸­å›½èµ„äº§é•¿æœŸçœ‹å¥½ï¼ŒçŸ­æœŸä¿æŒè°¨æ…è§‚æœ›

ğŸ›ï¸ æ”¿ç­–å¯¼å‘:
â€¢ ğŸ”¬ ç§‘æŠ€åˆ›æ–°: å¼ºåŒ–ç§‘æŠ€è‡ªç«‹è‡ªå¼ºï¼Œæ”¯æŒå…³é”®æ ¸å¿ƒæŠ€æœ¯æ”»å…³
â€¢ ğŸŒ± ç»¿è‰²å‘å±•: ç¢³è¾¾å³°ç¢³ä¸­å’Œç›®æ ‡æ¨è¿›ï¼Œæ–°èƒ½æºäº§ä¸šè·æ”¯æŒ
â€¢ ğŸ›ï¸ æ¶ˆè´¹å‡çº§: ä¿ƒè¿›å†…éœ€æ‰©å¤§å’Œæ¶ˆè´¹ç»“æ„å‡çº§
â€¢ ğŸ­ åˆ¶é€ å¼ºå›½: æ¨åŠ¨åˆ¶é€ ä¸šæ•°å­—åŒ–è½¬å‹å’Œé«˜è´¨é‡å‘å±•

ğŸ“Š è¡Œä¸šçƒ­ç‚¹:
â€¢ ğŸ¤– äººå·¥æ™ºèƒ½: AIåº”ç”¨åœºæ™¯ä¸æ–­æ‹“å±•ï¼Œç›¸å…³æ¦‚å¿µè‚¡å—å…³æ³¨
â€¢ âš¡ æ–°èƒ½æº: å‚¨èƒ½ã€å…‰ä¼ã€é£ç”µç­‰ç»†åˆ†é¢†åŸŸæŒç»­å—ç›Š
â€¢ ğŸ’Š åŒ»è¯ç”Ÿç‰©: åˆ›æ–°è¯ã€åŒ»ç–—å™¨æ¢°ç­‰é¢†åŸŸæ”¿ç­–æ”¯æŒåŠ›åº¦åŠ å¤§
â€¢ ğŸš— æ–°èƒ½æºè½¦: äº§ä¸šé“¾æˆç†Ÿåº¦æå‡ï¼Œå‡ºæµ·ä¸šåŠ¡å¿«é€Ÿå‘å±•

âš ï¸ æŠ•èµ„æé†’
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ æœ¬åˆ†æåŸºäºå…¬å¼€ä¿¡æ¯å’ŒæŠ€æœ¯æ¨¡å‹ï¼Œä»…ä¾›å‚è€ƒ
â€¢ è‚¡ç¥¨æŠ•èµ„å­˜åœ¨é£é™©ï¼Œå¯èƒ½é¢ä¸´æœ¬é‡‘æŸå¤±
â€¢ è¯·æ ¹æ®è‡ªèº«é£é™©æ‰¿å—èƒ½åŠ›å’ŒæŠ•èµ„ç›®æ ‡è°¨æ…å†³ç­–
â€¢ å»ºè®®åˆ†æ•£æŠ•èµ„ï¼Œé¿å…é›†ä¸­æŒä»“å•ä¸€è‚¡ç¥¨
â€¢ å…³æ³¨å…¬å¸åŸºæœ¬é¢å˜åŒ–å’Œè¡Œä¸šå‘å±•è¶‹åŠ¿
"""
        
        return overview
    
    def technical_analysis(self, ticker):
        """æŠ€æœ¯é¢åˆ†æ"""
        stock_info = self.stock_info.get(ticker, {})
        current_price = stock_info.get("price", 0)
        
        # ç”Ÿæˆæ¨¡æ‹Ÿçš„æŠ€æœ¯æŒ‡æ ‡æ•°æ®
        ma5 = current_price * random.uniform(0.98, 1.02)
        ma10 = current_price * random.uniform(0.95, 1.05)
        ma20 = current_price * random.uniform(0.92, 1.08)
        ma60 = current_price * random.uniform(0.88, 1.12)
        
        rsi = random.uniform(30, 70)
        macd = random.uniform(-0.5, 0.5)
        signal = random.uniform(-0.3, 0.3)
        
        volume_ratio = random.uniform(0.5, 2.5)
        price_change = random.uniform(-3, 3)
        
        analysis = f"""
ğŸ“ˆ æŠ€æœ¯é¢åˆ†ææŠ¥å‘Š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ä»·æ ¼ä¿¡æ¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å½“å‰ä»·æ ¼: Â¥{current_price:.2f}
æ—¥å†…å˜åŠ¨: {price_change:+.2f}%
ä»Šæ—¥é‡æ¯”: {volume_ratio:.2f}
æˆäº¤æ´»è·ƒåº¦: {'ğŸ”¥ æ´»è·ƒ' if volume_ratio > 1.5 else 'ğŸ“Š æ­£å¸¸' if volume_ratio > 0.8 else 'â„ï¸ æ¸…æ·¡'}

ğŸ“ˆ ç§»åŠ¨å¹³å‡çº¿åˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
MA5  (5æ—¥çº¿):  Â¥{ma5:.2f}  {'ğŸŸ¢ å¤šå¤´' if current_price > ma5 else 'ğŸ”´ ç©ºå¤´'}
MA10 (10æ—¥çº¿): Â¥{ma10:.2f}  {'ğŸŸ¢ å¤šå¤´' if current_price > ma10 else 'ğŸ”´ ç©ºå¤´'}
MA20 (20æ—¥çº¿): Â¥{ma20:.2f}  {'ğŸŸ¢ å¤šå¤´' if current_price > ma20 else 'ğŸ”´ ç©ºå¤´'}
MA60 (60æ—¥çº¿): Â¥{ma60:.2f}  {'ğŸŸ¢ å¤šå¤´' if current_price > ma60 else 'ğŸ”´ ç©ºå¤´'}

ğŸ“Š æŠ€æœ¯æŒ‡æ ‡åˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
RSI (ç›¸å¯¹å¼ºå¼±æŒ‡æ ‡): {rsi:.1f}
"""
        
        if rsi > 70:
            analysis += "    ğŸ“Š çŠ¶æ€: ğŸ”¥ è¶…ä¹°åŒºåŸŸï¼Œæ³¨æ„å›è°ƒé£é™©\n"
        elif rsi < 30:
            analysis += "    ğŸ“Š çŠ¶æ€: â„ï¸ è¶…å–åŒºåŸŸï¼Œå¯èƒ½è¿æ¥åå¼¹\n"
        else:
            analysis += "    ğŸ“Š çŠ¶æ€: ğŸ“Š æ­£å¸¸åŒºåŸŸï¼Œè¶‹åŠ¿å¥åº·\n"
        
        analysis += f"""
MACDå¿«çº¿: {macd:.3f}
MACDæ…¢çº¿: {signal:.3f}
MACDçŠ¶æ€: {'ğŸŸ¢ é‡‘å‰çœ‹æ¶¨' if macd > signal else 'ğŸ”´ æ­»å‰çœ‹è·Œ'}

ğŸ¯ è¶‹åŠ¿åˆ¤æ–­
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
        
        # è¶‹åŠ¿åˆ¤æ–­é€»è¾‘
        if ma5 > ma10 > ma20:
            if ma20 > ma60:
                analysis += "ğŸ“ˆ å¼ºåŠ¿å¤šå¤´æ’åˆ—: ä¸Šæ¶¨è¶‹åŠ¿æ˜ç¡® ğŸš€\n"
                trend_signal = "å¼ºçƒˆçœ‹å¤š"
            else:
                analysis += "ğŸ“ˆ çŸ­æœŸå¤šå¤´æ’åˆ—: åå¼¹è¶‹åŠ¿ ğŸ“ˆ\n"
                trend_signal = "çœ‹å¤š"
        elif ma5 < ma10 < ma20:
            if ma20 < ma60:
                analysis += "ğŸ“‰ ç©ºå¤´æ’åˆ—: ä¸‹è·Œè¶‹åŠ¿æ˜æ˜¾ ğŸ“‰\n"
                trend_signal = "çœ‹ç©º"
            else:
                analysis += "ğŸ“‰ çŸ­æœŸè°ƒæ•´: å›è°ƒä¸­ ğŸ“Š\n"
                trend_signal = "ä¸­æ€§åç©º"
        else:
            analysis += "ğŸŒŠ å‡çº¿çº ç¼ : æ–¹å‘å¾…æ˜ç¡® ğŸŒŠ\n"
            trend_signal = "éœ‡è¡"
        
        # æˆäº¤é‡åˆ†æ
        if volume_ratio > 1.8:
            analysis += "ğŸ“ˆ æˆäº¤é‡: æ˜¾è‘—æ”¾é‡ï¼Œèµ„é‡‘å…³æ³¨åº¦é«˜\n"
        elif volume_ratio > 1.2:
            analysis += "ğŸ“ˆ æˆäº¤é‡: é€‚åº¦æ”¾é‡ï¼Œå¸‚åœºå‚ä¸ç§¯æ\n"
        elif volume_ratio < 0.6:
            analysis += "ğŸ“‰ æˆäº¤é‡: æ˜æ˜¾ç¼©é‡ï¼Œè§‚æœ›æƒ…ç»ªæµ“åš\n"
        else:
            analysis += "ğŸ“Š æˆäº¤é‡: æ­£å¸¸æ°´å¹³\n"
        
        analysis += f"""
ğŸ’¡ æŠ€æœ¯é¢ç»¼åˆè¯„ä¼°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è¶‹åŠ¿ä¿¡å·: {trend_signal}
å…³é”®æ”¯æ’‘: Â¥{min(ma10, ma20, ma60):.2f}
å…³é”®é˜»åŠ›: Â¥{max(ma10, ma20, ma60):.2f}
"""
        
        # æ“ä½œå»ºè®®
        if rsi > 70 and trend_signal in ["å¼ºçƒˆçœ‹å¤š", "çœ‹å¤š"]:
            analysis += "âš ï¸ è™½ç„¶è¶‹åŠ¿å‘å¥½ï¼Œä½†RSIè¶…ä¹°ï¼Œå»ºè®®ç­‰å¾…å›è°ƒå†ä»‹å…¥\n"
        elif rsi < 30 and trend_signal in ["çœ‹ç©º", "ä¸­æ€§åç©º"]:
            analysis += "ğŸ’¡ è™½ç„¶è¶‹åŠ¿åå¼±ï¼Œä½†RSIè¶…å–ï¼Œå¯å…³æ³¨åå¼¹æœºä¼š\n"
        elif trend_signal == "å¼ºçƒˆçœ‹å¤š":
            analysis += "âœ… æŠ€æœ¯é¢å¼ºåŠ¿ï¼Œè¶‹åŠ¿å‘ä¸Šï¼Œå¯è€ƒè™‘é€¢ä½å¸ƒå±€\n"
        elif trend_signal == "çœ‹ç©º":
            analysis += "âŒ æŠ€æœ¯é¢åå¼±ï¼Œå»ºè®®è°¨æ…æˆ–é€‚å½“å‡ä»“\n"
        else:
            analysis += "ğŸ”„ éœ‡è¡è¡Œæƒ…ï¼Œå»ºè®®ç­‰å¾…è¶‹åŠ¿æ˜ç¡®åå†è¡ŒåŠ¨\n"
        
        analysis += """
ğŸ“ˆ å…³é”®æŠ€æœ¯ä½
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ å¦‚æœçªç ´ä¸Šæ–¹é˜»åŠ›ä½ï¼Œæœ‰æœ›å¼€å¯æ–°ä¸€è½®ä¸Šæ¶¨
â€¢ å¦‚æœè·Œç ´ä¸‹æ–¹æ”¯æ’‘ä½ï¼Œéœ€è¦è­¦æƒ•è¿›ä¸€æ­¥è°ƒæ•´
â€¢ å»ºè®®ç»“åˆæˆäº¤é‡å˜åŒ–åˆ¤æ–­çªç ´æœ‰æ•ˆæ€§
â€¢ æ³¨æ„è®¾ç½®åˆç†çš„æ­¢æŸå’Œæ­¢ç›ˆä½ç½®

ğŸ“ æŠ€æœ¯é¢é£é™©æç¤º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ æŠ€æœ¯åˆ†æåŸºäºå†å²æ•°æ®ï¼Œä¸èƒ½å®Œå…¨é¢„æµ‹æœªæ¥
â€¢ Aè‚¡å¸‚åœºæƒ…ç»ªåŒ–ç‰¹å¾æ˜æ˜¾ï¼ŒæŠ€æœ¯æŒ‡æ ‡å¯èƒ½å¤±æ•ˆ
â€¢ å»ºè®®ç»“åˆåŸºæœ¬é¢åˆ†æå’Œå¸‚åœºç¯å¢ƒç»¼åˆåˆ¤æ–­
â€¢ æ³¨æ„æ§åˆ¶ä»“ä½ï¼Œè®¾ç½®æ­¢æŸä¿æŠ¤æœ¬é‡‘å®‰å…¨
"""
        
        return analysis
    
    def fundamental_analysis(self, ticker):
        """åŸºæœ¬é¢åˆ†æ"""
        stock_info = self.stock_info.get(ticker, {})
        
        # ç”Ÿæˆæ¨¡æ‹Ÿçš„è´¢åŠ¡æ•°æ®
        market_cap = random.uniform(500, 8000)
        pe_ratio = random.uniform(15, 45)
        pb_ratio = random.uniform(1.2, 3.5)
        roe = random.uniform(8, 25)
        revenue_growth = random.uniform(-10, 30)
        profit_growth = random.uniform(-20, 40)
        
        analysis = f"""
ğŸ’¼ åŸºæœ¬é¢åˆ†ææŠ¥å‘Š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¢ å…¬å¸åŸºæœ¬ä¿¡æ¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å…¬å¸åç§°: {stock_info.get('name', 'æœªçŸ¥')}
æ‰€å±è¡Œä¸š: {stock_info.get('industry', 'æœªçŸ¥')}
æŠ•èµ„æ¦‚å¿µ: {stock_info.get('concept', 'æœªçŸ¥')}
ä¸Šå¸‚æ¿å—: {'ç§‘åˆ›æ¿' if ticker.startswith('688') else 'åˆ›ä¸šæ¿' if ticker.startswith('300') else 'æ²ªå¸‚ä¸»æ¿' if ticker.startswith('60') else 'æ·±å¸‚ä¸»æ¿'}

ğŸ’° å…³é”®è´¢åŠ¡æŒ‡æ ‡
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»å¸‚å€¼: Â¥{market_cap:.1f} äº¿
å¸‚ç›ˆç‡(PE): {pe_ratio:.1f}å€
å¸‚å‡€ç‡(PB): {pb_ratio:.2f}å€
å‡€èµ„äº§æ”¶ç›Šç‡(ROE): {roe:.1f}%
è¥æ”¶å¢é•¿ç‡: {revenue_growth:+.1f}%
å‡€åˆ©æ¶¦å¢é•¿ç‡: {profit_growth:+.1f}%

ğŸ“Š ä¼°å€¼åˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
        
        # PEä¼°å€¼åˆ†æ
        if pe_ratio < 20:
            analysis += f"ğŸ“Š PEä¼°å€¼({pe_ratio:.1f}å€): ä¼°å€¼ç›¸å¯¹åˆç†ï¼Œå…·æœ‰æŠ•èµ„ä»·å€¼\n"
        elif pe_ratio < 35:
            analysis += f"ğŸ“Š PEä¼°å€¼({pe_ratio:.1f}å€): ä¼°å€¼åé«˜ï¼Œéœ€å…³æ³¨ä¸šç»©å¢é•¿\n"
        else:
            analysis += f"ğŸ“Š PEä¼°å€¼({pe_ratio:.1f}å€): ä¼°å€¼è¾ƒé«˜ï¼Œå­˜åœ¨æ³¡æ²«é£é™©\n"
        
        # ROEåˆ†æ
        if roe > 15:
            analysis += f"ğŸ’ª ROE({roe:.1f}%): ç›ˆåˆ©èƒ½åŠ›ä¼˜ç§€ï¼Œå…¬å¸è´¨åœ°è‰¯å¥½\n"
        elif roe > 10:
            analysis += f"ğŸ“Š ROE({roe:.1f}%): ç›ˆåˆ©èƒ½åŠ›å°šå¯ï¼Œç¬¦åˆè¡Œä¸šå¹³å‡\n"
        else:
            analysis += f"âš ï¸ ROE({roe:.1f}%): ç›ˆåˆ©èƒ½åŠ›åå¼±ï¼Œéœ€å…³æ³¨æ”¹å–„ç©ºé—´\n"
        
        analysis += """
ğŸ­ è¡Œä¸šåˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
        
        # æ ¹æ®è¡Œä¸šæä¾›åˆ†æ
        industry = stock_info.get("industry", "")
        if "åŠå¯¼ä½“" in industry:
            analysis += """
ğŸ”¬ åŠå¯¼ä½“è¡Œä¸šç‰¹ç‚¹:
â€¢ å›½äº§æ›¿ä»£ç©ºé—´å·¨å¤§ï¼Œæ”¿ç­–æ”¯æŒåŠ›åº¦å¼º
â€¢ æŠ€æœ¯å£å’é«˜ï¼Œé¢†å…ˆä¼ä¸šæŠ¤åŸæ²³æ·±
â€¢ å‘¨æœŸæ€§ç‰¹å¾æ˜æ˜¾ï¼Œéœ€å…³æ³¨è¡Œä¸šæ™¯æ°”åº¦
â€¢ ä¼°å€¼æº¢ä»·åˆç†ï¼Œæˆé•¿æ€§æ˜¯å…³é”®
â€¢ å…³æ³¨ç ”å‘æŠ•å…¥å’Œæ ¸å¿ƒæŠ€æœ¯çªç ´
"""
        elif "é“¶è¡Œ" in industry:
            analysis += """
ğŸ¦ é“¶è¡Œä¸šç‰¹ç‚¹:
â€¢ å—ç›Šäºç»æµå¤è‹å’Œåˆ©ç‡ç¯å¢ƒæ”¹å–„
â€¢ èµ„äº§è´¨é‡æ˜¯æ ¸å¿ƒå…³æ³¨ç‚¹
â€¢ ä¼°å€¼æ™®éåä½ï¼Œè‚¡æ¯ç‡è¾ƒé«˜
â€¢ æ”¿ç­–æ”¯æŒå®ä½“ç»æµï¼Œä¸šåŠ¡ç©ºé—´æ‰©å¤§
â€¢ å…³æ³¨ä¸è‰¯ç‡å˜åŒ–å’Œæ‹¨å¤‡è¦†ç›–ç‡
"""
        elif "æˆ¿åœ°äº§" in industry:
            analysis += """
ğŸ  æˆ¿åœ°äº§è¡Œä¸šç‰¹ç‚¹:
â€¢ æ”¿ç­–åº•éƒ¨å·²ç°ï¼Œè¾¹é™…æ”¹å–„æ˜æ˜¾
â€¢ è¡Œä¸šé›†ä¸­åº¦æå‡ï¼Œé¾™å¤´å—ç›Š
â€¢ ç°é‡‘æµå’Œå€ºåŠ¡é£é™©æ˜¯å…³é”®
â€¢ ä¼°å€¼å¤„äºå†å²ä½ä½
â€¢ å…³æ³¨é”€å”®å›æš–å’Œæ”¿ç­–å˜åŒ–
"""
        elif "æ–°èƒ½æº" in industry:
            analysis += """
âš¡ æ–°èƒ½æºè¡Œä¸šç‰¹ç‚¹:
â€¢ é•¿æœŸæˆé•¿é€»è¾‘æ¸…æ™°ï¼Œæ”¿ç­–æŒç»­æ”¯æŒ
â€¢ æŠ€æœ¯è¿›æ­¥å¿«ï¼Œæˆæœ¬ä¸‹é™æ˜æ˜¾
â€¢ å¸‚åœºç«äº‰æ¿€çƒˆï¼Œæ ¼å±€å°šæœªç¨³å®š
â€¢ ä¼°å€¼æ³¢åŠ¨å¤§ï¼Œæˆé•¿æ€§æº¢ä»·æ˜æ˜¾
â€¢ å…³æ³¨æŠ€æœ¯è·¯çº¿å’Œå¸‚åœºä»½é¢å˜åŒ–
"""
        elif "ç™½é…’" in industry:
            analysis += """
ğŸ¶ ç™½é…’è¡Œä¸šç‰¹ç‚¹:
â€¢ æ¶ˆè´¹å‡çº§è¶‹åŠ¿ä¸å˜ï¼Œé«˜ç«¯åŒ–æŒç»­
â€¢ å“ç‰Œå£å’æ·±åšï¼Œé¾™å¤´åœ°ä½ç¨³å›º
â€¢ ç°é‡‘æµä¼˜ç§€ï¼Œåˆ†çº¢ç¨³å®š
â€¢ ä¼°å€¼åˆç†ï¼Œé•¿æœŸæŠ•èµ„ä»·å€¼æ˜¾è‘—
â€¢ å…³æ³¨æ¸ é“å˜åŒ–å’Œæ¶ˆè´¹å¤è‹è¿›åº¦
"""
        else:
            analysis += f"""
ğŸ“Š {industry}è¡Œä¸šåˆ†æ:
â€¢ å…³æ³¨è¡Œä¸šæ”¿ç­–ç¯å¢ƒå’Œç«äº‰æ ¼å±€å˜åŒ–
â€¢ é‡è§†å…¬å¸åœ¨äº§ä¸šé“¾ä¸­çš„åœ°ä½
â€¢ è€ƒè™‘è¡Œä¸šå‘¨æœŸæ€§å’Œæˆé•¿æ€§ç‰¹å¾
â€¢ å…³æ³¨æŠ€æœ¯åˆ›æ–°å’Œå•†ä¸šæ¨¡å¼æ¼”è¿›
"""
        
        analysis += f"""
ğŸ‡¨ğŸ‡³ Aè‚¡ç‰¹è‰²åˆ†æ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä¸šç»©å¢é•¿: {revenue_growth:+.1f}%è¥æ”¶ | {profit_growth:+.1f}%å‡€åˆ©æ¶¦
"""
        
        if revenue_growth > 15 and profit_growth > 20:
            analysis += "ğŸš€ é«˜æˆé•¿å‹å…¬å¸ï¼Œä¸šç»©å¢é•¿å¼ºåŠ²\n"
        elif revenue_growth > 5 and profit_growth > 10:
            analysis += "ğŸ“ˆ ç¨³å¥æˆé•¿å‹å…¬å¸ï¼Œä¸šç»©å¢é•¿ç¨³å®š\n"
        elif revenue_growth < 0 or profit_growth < 0:
            analysis += "âš ï¸ ä¸šç»©æ‰¿å‹ï¼Œéœ€å…³æ³¨åŸºæœ¬é¢æ”¹å–„\n"
        else:
            analysis += "ğŸ“Š ä¸šç»©å¢é•¿å¹³ç¨³ï¼Œç¬¦åˆé¢„æœŸ\n"
        
        analysis += """
ğŸ’ æŠ•èµ„ä»·å€¼è¯„ä¼°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ å»ºè®®å…³æ³¨å…¬å¸æœ€æ–°è´¢æŠ¥å’Œä¸šç»©æŒ‡å¼•
â€¢ è·Ÿè¸ªè¡Œä¸šæ”¿ç­–å˜åŒ–å’Œå¸‚åœºç«äº‰æ€åŠ¿
â€¢ é‡è§†å…¬å¸æ²»ç†ç»“æ„å’Œç®¡ç†å±‚æ‰§è¡ŒåŠ›
â€¢ è€ƒè™‘åˆ†çº¢æ”¿ç­–å’Œè‚¡ä¸œå›æŠ¥æ°´å¹³

ğŸ“ˆ å…³æ³¨è¦ç‚¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ å®šæœŸè´¢æŠ¥: å…³æ³¨è¥æ”¶ã€åˆ©æ¶¦ã€ç°é‡‘æµå˜åŒ–
â€¢ ä¸šç»©é¢„å‘Š: æå‰äº†è§£å…¬å¸ç»è¥çŠ¶å†µ
â€¢ è¡Œä¸šåŠ¨æ€: è·Ÿè¸ªæ”¿ç­–å˜åŒ–å’ŒæŠ€æœ¯å‘å±•
â€¢ æœºæ„ç ”æŠ¥: å‚è€ƒä¸“ä¸šæœºæ„åˆ†æè§‚ç‚¹

âš ï¸ é£é™©æç¤º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ è´¢åŠ¡æ•°æ®å¯èƒ½å­˜åœ¨æ»åæ€§ï¼Œéœ€ç»“åˆæœ€æ–°å…¬å‘Š
â€¢ æ³¨æ„å…³è”äº¤æ˜“å’Œå¤§è‚¡ä¸œèµ„é‡‘å ç”¨é£é™©
â€¢ å…³æ³¨å®¡è®¡æ„è§å’Œä¼šè®¡æ”¿ç­–å˜æ›´
â€¢ è­¦æƒ•ä¸šç»©é€ å‡å’Œè´¢åŠ¡èˆå¼Šé£é™©
â€¢ é‡è§†å•†èª‰å‡å€¼å’Œèµ„äº§è´¨é‡å˜åŒ–
"""
        
        return analysis
    
    def generate_investment_recommendation(self, ticker, technical_score, fundamental_score):
        """ç”ŸæˆæŠ•èµ„å»ºè®®"""
        total_score = (technical_score + fundamental_score) / 2
        
        if total_score >= 7.5:
            rating = "å¼ºçƒˆæ¨è â­â­â­â­â­"
            action = "ç§¯æä¹°å…¥"
            risk_level = "ä¸­ç­‰é£é™©"
            position = "5-10%"
        elif total_score >= 6.5:
            rating = "æ¨è â­â­â­â­"
            action = "ä¹°å…¥"
            risk_level = "ä¸­ç­‰é£é™©"
            position = "3-8%"
        elif total_score >= 5.5:
            rating = "ä¸­æ€§ â­â­â­"
            action = "æŒæœ‰è§‚æœ›"
            risk_level = "ä¸­ç­‰é£é™©"
            position = "2-5%"
        elif total_score >= 4.5:
            rating = "è°¨æ… â­â­"
            action = "å‡æŒ"
            risk_level = "è¾ƒé«˜é£é™©"
            position = "0-3%"
        else:
            rating = "ä¸æ¨è â­"
            action = "å–å‡º"
            risk_level = "é«˜é£é™©"
            position = "0%"
        
        stock_info = self.stock_info.get(ticker, {})
        
        recommendation = f"""
ğŸ¯ æŠ•èµ„å»ºè®®æŠ¥å‘Š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ç»¼åˆè¯„ä¼°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ•èµ„è¯„çº§: {rating}
æ“ä½œå»ºè®®: {action}
é£é™©ç­‰çº§: {risk_level}
å»ºè®®ä»“ä½: {position}

ğŸ“ˆ è¯„åˆ†è¯¦æƒ…
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ€æœ¯é¢è¯„åˆ†: {technical_score:.1f}/10.0
åŸºæœ¬é¢è¯„åˆ†: {fundamental_score:.1f}/10.0
ç»¼åˆè¯„åˆ†: {total_score:.1f}/10.0

ğŸ’¡ æŠ•èµ„ç­–ç•¥å»ºè®®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
        
        # æ ¹æ®è¡Œä¸šç»™å‡ºå…·ä½“å»ºè®®
        industry = stock_info.get("industry", "")
        if "åŠå¯¼ä½“" in industry:
            recommendation += """
ğŸ”¬ åŠå¯¼ä½“æŠ•èµ„ç­–ç•¥:
â€¢ æŠ•èµ„é€»è¾‘: å›½äº§æ›¿ä»£+ç§‘æŠ€è‡ªç«‹è‡ªå¼ºåŒé‡é©±åŠ¨
â€¢ ä¹°å…¥æ—¶æœº: è¡Œä¸šè°ƒæ•´åä¼°å€¼å›è½è‡³åˆç†åŒºé—´
â€¢ æŒæœ‰å‘¨æœŸ: 3-5å¹´é•¿çº¿æŠ•èµ„ï¼Œäº«å—æˆé•¿çº¢åˆ©
â€¢ é£é™©æ§åˆ¶: å…³æ³¨å›½é™…ç¯å¢ƒå˜åŒ–å’ŒæŠ€æœ¯ç«äº‰
â€¢ é‡ç‚¹å…³æ³¨: è®¾è®¡ã€åˆ¶é€ ã€è®¾å¤‡ã€ææ–™å…¨äº§ä¸šé“¾
"""
        elif "é“¶è¡Œ" in industry:
            recommendation += """
ğŸ¦ é“¶è¡ŒæŠ•èµ„ç­–ç•¥:
â€¢ æŠ•èµ„é€»è¾‘: ç»æµå¤è‹+æ¯å·®æ”¹å–„+èµ„äº§è´¨é‡å‘å¥½
â€¢ ä¹°å…¥æ—¶æœº: ä¼°å€¼å¤„äºå†å²ä½ä½ä¸”æ”¿ç­–è¾¹é™…æ”¹å–„
â€¢ æŒæœ‰å‘¨æœŸ: 1-3å¹´ä¸­é•¿æœŸé…ç½®ï¼Œå…¼é¡¾æˆé•¿ä¸åˆ†çº¢
â€¢ é£é™©æ§åˆ¶: å…³æ³¨èµ„äº§è´¨é‡å’Œç›‘ç®¡æ”¿ç­–å˜åŒ–
â€¢ é‡ç‚¹å…³æ³¨: é›¶å”®é“¶è¡Œè½¬å‹å’Œæ•°å­—åŒ–ç¨‹åº¦
"""
        elif "æˆ¿åœ°äº§" in industry:
            recommendation += """
ğŸ  åœ°äº§æŠ•èµ„ç­–ç•¥:
â€¢ æŠ•èµ„é€»è¾‘: æ”¿ç­–åº•ç¡®ç«‹+è¡Œä¸šå‡ºæ¸…+é¾™å¤´é›†ä¸­åº¦æå‡
â€¢ ä¹°å…¥æ—¶æœº: é”€å”®æ•°æ®è¾¹é™…æ”¹å–„ä¸”å€ºåŠ¡é£é™©å¯æ§
â€¢ æŒæœ‰å‘¨æœŸ: 1-2å¹´ä¸­æœŸæŠ•èµ„ï¼ŒæŠŠæ¡æ”¿ç­–å‘¨æœŸ
â€¢ é£é™©æ§åˆ¶: ä¸¥æ§å€ºåŠ¡é£é™©ï¼Œå…³æ³¨ç°é‡‘æµçŠ¶å†µ
â€¢ é‡ç‚¹å…³æ³¨: ä¸€äºŒçº¿å¸ƒå±€+è´¢åŠ¡ç¨³å¥çš„é¾™å¤´
"""
        elif "æ–°èƒ½æº" in industry:
            recommendation += """
âš¡ æ–°èƒ½æºæŠ•èµ„ç­–ç•¥:
â€¢ æŠ•èµ„é€»è¾‘: èƒ½æºè½¬å‹+æŠ€æœ¯è¿›æ­¥+æˆæœ¬ä¸‹é™
â€¢ ä¹°å…¥æ—¶æœº: äº§ä¸šæ”¿ç­–æ˜ç¡®ä¸”æŠ€æœ¯è·¯çº¿æ¸…æ™°
â€¢ æŒæœ‰å‘¨æœŸ: 3-5å¹´é•¿æœŸæŒæœ‰ï¼Œåˆ†äº«è¡Œä¸šæˆé•¿
â€¢ é£é™©æ§åˆ¶: å…³æ³¨æŠ€æœ¯è·¯çº¿å˜åŒ–å’Œç«äº‰æ ¼å±€
â€¢ é‡ç‚¹å…³æ³¨: å‚¨èƒ½ã€ç”µæ± ã€å…‰ä¼ã€é£ç”µç»†åˆ†é¾™å¤´
"""
        elif "ç™½é…’" in industry:
            recommendation += """
ğŸ¶ ç™½é…’æŠ•èµ„ç­–ç•¥:
â€¢ æŠ•èµ„é€»è¾‘: æ¶ˆè´¹å‡çº§+å“ç‰Œä»·å€¼+æ¸ é“ä¼˜åŠ¿
â€¢ ä¹°å…¥æ—¶æœº: æ¶ˆè´¹å¤è‹é¢„æœŸå¼ºåŒ–ï¼Œä¼°å€¼åˆç†
â€¢ æŒæœ‰å‘¨æœŸ: 3-5å¹´é•¿æœŸæŠ•èµ„ï¼Œæ ¸å¿ƒèµ„äº§é…ç½®
â€¢ é£é™©æ§åˆ¶: å…³æ³¨æ¶ˆè´¹ç¯å¢ƒå˜åŒ–å’Œç«äº‰æ€åŠ¿
â€¢ é‡ç‚¹å…³æ³¨: å…¨å›½åŒ–å¸ƒå±€+é«˜ç«¯åŒ–æˆåŠŸçš„å“ç‰Œ
"""
        else:
            recommendation += f"""
ğŸ“Š {industry}æŠ•èµ„ç­–ç•¥:
â€¢ æŠ•èµ„é€»è¾‘: æ ¹æ®è¡Œä¸šç‰¹ç‚¹å’Œå…¬å¸åœ°ä½ç¡®å®š
â€¢ ä¹°å…¥æ—¶æœº: åŸºæœ¬é¢å‘å¥½ä¸”ä¼°å€¼åˆç†æ—¶
â€¢ æŒæœ‰å‘¨æœŸ: æ ¹æ®å…¬å¸è´¨åœ°å’Œè¡Œä¸šå‘¨æœŸçµæ´»è°ƒæ•´
â€¢ é£é™©æ§åˆ¶: è®¾ç½®åˆç†æ­¢æŸï¼Œå…³æ³¨è¡Œä¸šå˜åŒ–
â€¢ é‡ç‚¹å…³æ³¨: è¡Œä¸šåœ°ä½ã€ç«äº‰ä¼˜åŠ¿ã€æˆé•¿ç©ºé—´
"""
        
        recommendation += f"""
ğŸ“‹ æ“ä½œå»ºè®®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å»ºè®®ä»“ä½: {position} (æ ¹æ®ä¸ªäººé£é™©æ‰¿å—èƒ½åŠ›è°ƒæ•´)
æ­¢æŸä½ç½®: é‡è¦æŠ€æœ¯æ”¯æ’‘ä½ä¸‹æ–¹8-10%
æ­¢ç›ˆç­–ç•¥: æ ¹æ®ä¼°å€¼æ°´å¹³å’ŒæŠ€æœ¯é˜»åŠ›ä½åˆ†æ‰¹æ­¢ç›ˆ
åŠ ä»“æ—¶æœº: æŠ€æœ¯é¢é…åˆåŸºæœ¬é¢å‘å¥½æ—¶é€¢ä½åŠ ä»“

ğŸ“… æŠ•èµ„æ—¶é—´æ¡†æ¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
çŸ­æœŸ(1-3ä¸ªæœˆ): {'è°¨æ…è§‚æœ›' if total_score < 6 else 'é€‚åº¦é…ç½®' if total_score < 7 else 'ç§¯æå‚ä¸'}
ä¸­æœŸ(3-12ä¸ªæœˆ): {'å‡æŒè§‚æœ›' if total_score < 5 else 'æŒæœ‰' if total_score < 7 else 'å¢æŒ'}
é•¿æœŸ(1-3å¹´): {'ä¸æ¨è' if total_score < 4.5 else 'å¯é…ç½®' if total_score < 6.5 else 'é‡ç‚¹é…ç½®'}

ğŸ“ åç»­è·Ÿè¸ªé‡ç‚¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ ğŸ“Š åŸºæœ¬é¢è·Ÿè¸ª: å­£åº¦è´¢æŠ¥ã€ä¸šç»©é¢„å‘Šã€ç»è¥æ•°æ®
â€¢ ğŸ“ˆ æŠ€æœ¯é¢è·Ÿè¸ª: å…³é”®æŠ€æœ¯ä½çªç ´ã€æˆäº¤é‡é…åˆ
â€¢ ğŸ›ï¸ æ”¿ç­–é¢è·Ÿè¸ª: è¡Œä¸šæ”¿ç­–ã€ç›‘ç®¡å˜åŒ–ã€å¸‚åœºç¯å¢ƒ
â€¢ ğŸ’° èµ„é‡‘é¢è·Ÿè¸ª: æœºæ„è°ƒç ”ã€åŒ—ä¸Šèµ„é‡‘ã€å¤§å®—äº¤æ˜“
â€¢ ğŸ“° æ¶ˆæ¯é¢è·Ÿè¸ª: å…¬å¸å…¬å‘Šã€è¡Œä¸šåŠ¨æ€ã€é‡å¤§äº‹é¡¹

ğŸ¯ æŠ•èµ„æˆåŠŸè¦ç´ 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. ğŸ“Š æ·±åº¦ç ”ç©¶: å……åˆ†äº†è§£å…¬å¸å’Œè¡Œä¸šåŸºæœ¬é¢
2. â° æ—¶æœºæŠŠæ¡: åœ¨åˆé€‚çš„æ—¶ç‚¹è¿›å…¥å’Œé€€å‡º
3. ğŸ¯ ä»“ä½ç®¡ç†: æ ¹æ®ç¡®å®šæ€§è°ƒæ•´ä»“ä½å¤§å°
4. ğŸ˜Œ æƒ…ç»ªæ§åˆ¶: é¿å…è¿½æ¶¨æ€è·Œï¼ŒåšæŒçºªå¾‹
5. ğŸ”„ åŠ¨æ€è°ƒæ•´: æ ¹æ®å˜åŒ–åŠæ—¶è°ƒæ•´æŠ•èµ„ç­–ç•¥

âš ï¸ é‡è¦é£é™©æç¤º
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”¸ å¸‚åœºé£é™©: Aè‚¡æ³¢åŠ¨æ€§è¾ƒå¤§ï¼Œå­˜åœ¨ç³»ç»Ÿæ€§ä¸‹è·Œé£é™©
ğŸ”¸ æ”¿ç­–é£é™©: ç›‘ç®¡æ”¿ç­–å˜åŒ–å¯èƒ½å¯¹è‚¡ä»·äº§ç”Ÿé‡å¤§å½±å“
ğŸ”¸ è¡Œä¸šé£é™©: è¡Œä¸šæ™¯æ°”åº¦å˜åŒ–å½±å“ç›¸å…³å…¬å¸è¡¨ç°
ğŸ”¸ ä¸ªè‚¡é£é™©: å…¬å¸ç»è¥ã€è´¢åŠ¡ã€æ²»ç†ç­‰æ–¹é¢çš„é£é™©
ğŸ”¸ æµåŠ¨æ€§é£é™©: å¸‚åœºæƒ…ç»ªå˜åŒ–å¯èƒ½å½±å“ä¸ªè‚¡æµåŠ¨æ€§
ğŸ”¸ ä¼°å€¼é£é™©: é«˜ä¼°å€¼è‚¡ç¥¨é¢ä¸´è¾ƒå¤§å›è°ƒé£é™©

ğŸ“œ æŠ•èµ„å…è´£å£°æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ æœ¬åˆ†ææŠ¥å‘ŠåŸºäºå…¬å¼€ä¿¡æ¯å’Œé‡åŒ–æ¨¡å‹ï¼Œä»…ä¾›æŠ•èµ„å‚è€ƒ
â€¢ ä¸æ„æˆå…·ä½“çš„æŠ•èµ„å»ºè®®ï¼Œä¸ä¿è¯æŠ•èµ„æ”¶ç›Š
â€¢ è‚¡ç¥¨æŠ•èµ„å­˜åœ¨é£é™©ï¼Œè¿‡å¾€è¡¨ç°ä¸ä»£è¡¨æœªæ¥ä¸šç»©
â€¢ è¯·æ ¹æ®è‡ªèº«æƒ…å†µè°¨æ…å†³ç­–ï¼Œç†æ€§æŠ•èµ„
â€¢ å»ºè®®å’¨è¯¢ä¸“ä¸šæŠ•èµ„é¡¾é—®ï¼Œåˆ¶å®šä¸ªæ€§åŒ–æŠ•èµ„æ–¹æ¡ˆ

ğŸ’ ç¥æ‚¨æŠ•èµ„æˆåŠŸï¼Œè´¢å¯Œå¢é•¿ï¼
"""
        
        return recommendation

def main():
    """ä¸»å‡½æ•°"""
    root = tk.Tk()
    app = AShareAnalyzerGUI(root)
    
    # è®¾ç½®çª—å£å±…ä¸­
    root.update_idletasks()
    width = root.winfo_width()
    height = root.winfo_height()
    x = (root.winfo_screenwidth() // 2) - (width // 2)
    y = (root.winfo_screenheight() // 2) - (height // 2)
    root.geometry(f'{width}x{height}+{x}+{y}')
    
    # è®¾ç½®çª—å£å…³é—­äº‹ä»¶
    def on_closing():
        if messagebox.askokcancel("é€€å‡ºç¡®è®¤", "ç¡®å®šè¦é€€å‡ºAè‚¡æ™ºèƒ½åˆ†æç³»ç»Ÿå—ï¼Ÿ"):
            root.destroy()
    
    root.protocol("WM_DELETE_WINDOW", on_closing)
    
    print("ğŸš€ Aè‚¡æ™ºèƒ½åˆ†æç³»ç»ŸGUIå¯åŠ¨æˆåŠŸï¼")
    print("ğŸ“Š æ”¯æŒè‚¡ç¥¨ä»£ç : 688981, 600036, 000002, 300750, 600519ç­‰")
    print("ğŸ’¡ è¯·åœ¨GUIç•Œé¢ä¸­è¾“å…¥è‚¡ç¥¨ä»£ç è¿›è¡Œåˆ†æ")
    
    # å¯åŠ¨GUI
    root.mainloop()

if __name__ == "__main__":
    main()